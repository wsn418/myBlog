# 评论组件设计文档

## 1. 数据模型设计
### Comment 模型字段设计
- `_id`: ObjectId类型，评论唯一标识
- `targetId`: String类型，评论目标ID（文章ID或动态ID）
- `targetType`: String类型，评论目标类型（article/daily）
- `parentId`: ObjectId类型，父评论ID（可选，用于回复）
- `replyTo`: Object类型，回复对象信息（可选）
  - `nickname`: String类型，被回复者昵称
- `nickname`: String类型，评论者昵称
- `email`: String类型，评论者邮箱
- `website`: String类型，评论者网站（选填）
- `content`: String类型，评论内容
- `avatar`: String类型，评论者头像
- `createdAt`: Date类型，评论时间

## 2. API 接口设计
### 获取评论列表接口
- 路径: GET /api/comments
- 参数: 
  - targetId: 文章或动态ID（必填）
  - targetType: 评论目标类型（必填）
  - page: 页码（可选）
  - pageSize: 每页数量（可选）
- 返回数据:
  - 评论列表（包含回复）
  - 评论总数
  - 分页信息

### 发表评论/回复接口
- 路径: POST /api/comments
- 请求体:
  - targetId: 文章或动态ID（必填）
  - targetType: 评论目标类型（必填）
  - parentId: 父评论ID（回复时必填）
  - replyTo: 回复对象信息（回复时必填）
    - nickname: 被回复者昵称
  - nickname: 评论者昵称（必填）
  - email: 评论者邮箱（必填）
  - website: 评论者网站（选填）
  - content: 评论内容（必填）
- 返回数据:
  - 新评论的完整信息
  - 操作状态和消息

## 3. 前端组件设计
### CommentList 组件功能
- 评论列表展示
  - 按时间倒序展示评论
  - 显示评论者头像、昵称、时间
  - 显示评论内容
  - 显示回复按钮
- 回复展示
  - 回复直接显示在原评论下方
  - 回复内容格式：@被回复人 回复内容
  - 回复按钮与原评论相同
- 分页功能
  - 支持评论列表分页
  - 显示分页信息和控制器

### CommentForm 组件功能
- 基础评论功能
  - 昵称、邮箱、网站输入
  - 评论内容编辑器
  - 表情选择器
  - 图片上传功能
- 回复模式
  - 显示"回复@xxx"的提示
  - 支持取消回复
  - 自动聚焦到输入框
- 表单验证
  - 必填项验证
  - 邮箱格式验证
  - 内容长度限制

## 4. 交互设计
### 评论操作流程
1. 发表评论
   - 填写评论信息
   - 提交表单
   - 显示成功提示
   - 刷新评论列表

2. 回复评论
   - 点击回复按钮
   - 显示回复表单和提示
   - 填写回复内容
   - 提交回复
   - 在原评论下方显示回复

### 视觉反馈
- 提交时显示loading效果
- 成功/失败消息提示
- 表单验证即时反馈
- 回复表单平滑过渡

## 5. 样式设计要点
1. 评论布局
   - 头像在左，内容在右
   - 适当的间距和留白
   - 清晰的信息层级

2. 回复样式
   - 左侧缩进对齐
   - 使用浅色分隔线
   - 回复内容中的@标记突出显示

3. 交互元素
   - 按钮状态明确
   - 表单输入框反馈及时
   - 整体视觉风格统一 