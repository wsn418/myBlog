# 后台管理系统详细设计

## 一、仪表盘设计

### 1.1 数据统计卡片
- 文章总数
- 日常动态总数
- 标签总数
- 最近7天发布统计

### 1.2 图表展示
- 文章发布趋势图（按月统计）
- 标签使用分布饼图
- 最近活跃度热力图

## 二、文章管理模块

### 2.1 文章列表页
- 功能特点：
  - 支持标题搜索
  - 支持标签筛选
  - 支持时间范围筛选
  - 支持批量操作（删除、修改标签）
  
- 列表字段：
  - 标题
  - 发布时间
  - 更新时间
  - 标签
  - 字数统计
  - 操作按钮（编辑、删除）

### 2.2 文章编辑页
- 功能特点：
  - Markdown 编辑器
  - 实时预览
  - 自动保存草稿
  - 标签管理
  - 发布时间设置
  
- 表单字段：
  - 标题
  - 内容（Markdown）
  - 标签
  - 发布时间
  - 状态（草稿/已发布）

## 三、日常管理模块

### 3.1 日常列表页
- 功能特点：
  - 支持内容搜索
  - 支持时间范围筛选
  - 支持批量删除
  
- 列表字段：
  - 内容预览
  - 发布时间
  - 图片数量
  - 操作按钮（编辑、删除）

### 3.2 日常编辑页
- 功能特点：
  - 富文本编辑器
  - 图片上传
  - 表情选择器
  
- 表单字段：
  - 内容
  - 图片
  - 发布时间
  - 心情标签

## 四、标签管理模块

### 4.1 标签列表
- 功能特点：
  - 支持名称搜索
  - 显示使用次数
  - 支持批量操作
  
- 列表字段：
  - 标签名称
  - 创建时间
  - 使用次数
  - 操作按钮（编辑、删除）

## 五、技术实现

### 5.1 前端技术栈
- Vue 3
- Vue Router
- Pinia 状态管理
- Element Plus UI
- ECharts 图表
- Monaco Editor（代码编辑器）
- TinyMCE（富文本编辑器）

### 5.2 后端技术栈
- Node.js + Express
- MongoDB
- JWT 认证
- Multer（文件上传）
- Sharp（图片处理）

### 5.3 数据模型设计

#### 用户模型
```javascript
{
  username: String,
  password: String,
  role: String,
  lastLogin: Date,
  createdAt: Date
}
```

#### 文章模型扩展
```javascript
{
  // ... 现有字段 ...
  status: String,  // draft/published
  deletedAt: Date, // 软删除
  publishedAt: Date
}
```

#### 日常模型扩展
```javascript
{
  // ... 现有字段 ...
  mood: String,
  weather: String,
  location: String,
  deletedAt: Date
}
```

### 5.4 权限控制
- 登录认证
- 接口鉴权
- 路由守卫
- 操作日志记录

## 六、UI/UX 设计

### 6.1 整体布局
- 左侧固定导航栏
- 顶部状态栏
- 主内容区自适应
- 面包屑导航

### 6.2 交互设计
- 批量操作确认弹窗
- 操作成功/失败提示
- 加载状态展示
- 表单验证反馈

### 6.3 响应式设计
- 支持平板设备
- 移动端自适应布局
- 触摸操作优化

## 七、安全考虑

### 7.1 身份验证
- JWT Token 认证
- Token 自动续期
- 登录失败限制

### 7.2 数据安全
- XSS 防护
- CSRF 防护
- 敏感数据加密
- 操作日志记录

## 八、性能优化

### 8.1 前端优化
- 路由懒加载
- 组件按需加载
- 图片懒加载
- 本地缓存策略

### 8.2 后端优化
- 数据库索引优化
- 接口缓存
- 图片压缩
- 分页查询优化

## 评论管理功能

### 评论管理页面
- 展示所有评论列表
- 支持按文章/日常筛选
- 支持按时间范围筛选
- 支持删除操作
- 分页显示

### 评论删除功能
- 权限要求：需要管理员权限
- 功能描述：
  - 可以删除任意评论
  - 删除父评论时，其下所有子评论也会被删除
  - 删除后自动刷新列表
  - 删除前需确认

### API 接口设计

#### 删除评论
- 请求方法: DELETE
- 接口路径: `/api/comments/:id`
- 权限要求: 需要 token 验证
- 请求参数: 
  - id: 评论ID (路径参数)
- 响应格式:
```json
{
  "code": 0,
  "message": "删除成功"
}
```
- 错误响应:
```json
{
  "code": -1,
  "message": "删除失败原因"
}
```

### 前端实现
1. 评论列表中添加删除按钮（仅管理员可见）
2. 点击删除按钮时弹出确认对话框
3. 确认后调用删除 API
4. 删除成功后刷新评论列表
5. 删除失败时显示错误提示

### 数据库设计
- 评论表结构不变
- 删除父评论时通过 parentId 关联删除所有子评论 